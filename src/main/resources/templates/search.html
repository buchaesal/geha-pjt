<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="fragments/main_layout">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Mapapi Test</title>

<!-- jquery ui-->
<link rel="stylesheet" href="css/jquery-ui.min.css" />

<!-- bootstrap -->
<link rel="stylesheet" href="css/bootstrap.min.css" />

<!-- datepicker (min쓰면 안됨) -->
<link rel="stylesheet" href="css/datepicker.css" />

<style>
	@font-face { 
		font-family: 'S-CoreDream-3Light';
		src: url('fonts/SCDream3.otf') format('opentype');
		font-weight: normal;
		font-style: normal;
	}
	
	/* a tag reset */
	a:link, a:visited, a:active, a:hover {
		color: #000;
		text-decoration: none;
	}
	
	hr {
/* 		border-color: #FFB0AE;
		border-width: 1px;
		max-width: 97%; */
		visibility:hidden;
	}
	
	#mainNav { 
		background-image: url(../img/header.jpg); 
	}
	
	header {
		min-height: 13%;
	}
	
	.container{
		margin-top: 3rem;
	}
	
 	.searcharea{ 
  		border: 1px solid rgba(30,30,30,0.2);
  		border-radius: 0.5rem;
   		height: 100%;
   		margin-bottom:3rem;
 	}
 	
 	.form-control[readonly]{
 		background-color: #fff;
 	}
 	
 	#date {
		cursor: pointer;
	}	
	
 	input[type="text"]{ 
  		width:90%;
   		margin: 0 auto;
 	}

 	button.resetStyle {
 		position: static;
		border: 0;
	    top: 25px;
	    right: 0;
	    width: 24px;
	    height: 24px;
	    text-indent: -9999px;
 	}
	button#down{
		background: url(img/button/ico_minus.png) 50% 50% no-repeat;
	    background-size: 20px auto;
	}
	button#up{
		background: url(img/button/ico_plus.png) 50% 50% no-repeat;
	    background-size: 20px auto;
	}
 	 
 	.maparea{ 
 		margin-bottom:3rem;	
 	}
 	
 	#map{
 		background-color:gray;
 		height:450px;
 	}
 	
 	.house {
 		margin: 1rem 0;
 	}
	
	.housewrapper{
		margin-top: 1rem;
	}
	
	.houseborder{
		border:2px solid #FFB0AE;
	}
	
	#searchresult{
		min-height:300px;
	}
	
	.houseimage{
		width:100%;
		height:200px;
		background-size:cover;
	}
	
	.contentwrapper{
		padding:0rem 2rem;
		font-family: 'S-CoreDream-3Light';
	}
	
  	.content.gehaname{
		padding-top:0.7rem;
		height:6rem;
		text-align:left;
        word-break: keep-all;
        word-wrap: break-word;
	}
	.content span.gehaname{
		vertical-align: center;
	}
	.content.yellowline{
		color:rgba(255,167,38,1);
	}
	.content span.rating{
		background-color:rgba(255,167,38,1);
		color:#FFF;
		border-radius:0.3rem;
		padding: 0 0.3rem;
	}
	.content.tag{
		margin-top:1rem;
		height:3rem;
	}
	.content span.tag{
		display:inline-block;
		background-color:gray;
		border-radius:0.3rem;
		color:#FFF;
		margin-top:0.2rem;
		padding: 0.2rem 0.2rem;
	}
	.content.price{
		text-align:right;
		margin-top: 1rem;
		margin-bottom:1rem;
	}
	
	
	

 	
</style>
</head>
<body>

<div layout:fragment="content">
	<div class="container">
		<div class="row">
			<div class="col-md-3 col-sm-4 searcharea">
				<form role="form" action="#">
					<div class="form-group" style="margin-top:20px">
						<label for="date">날짜</label>
						<input id="date" type="text" data-range="true" data-multiple-dates-separator=" ~ " data-language="en" class="datepicker-here form-control" readonly/>
						<input type="hidden" id="startdate" name="bookingStart" />
						<input type="hidden" id="enddate" name="bookingEnd" />
					</div>
					
					<hr />
					
					<div class="form-group">
						<label for="keywordsearch">키워드 검색</label>
						<input type="text" id="keywordsearch" name="keyword" class="form-control"/>				
					</div>
					
					<hr />
					
					<div class="form-group">
						<div class="col-xs-6" style="padding-left:0px;padding-right:0px"><strong>인원</strong></div>
						<div class="col-xs-6" style="padding-left:0px;padding-right:0px">
							<button type="button" id="down" class="resetStyle">-</button>
							<span id="person">1</span>
							<input type="hidden" name="bookingNumber" class="person" value="1" />
							<button type="button" id="up" class="resetStyle">+</button>
						</div>
					</div>
					
					<hr /><br />
					
					<div class="form-group">
						<strong>가격</strong>
						<span id="amount" style="border:0; color:#f6931f; font-weight:bold;"></span><br /><br />
						<div id="slider-range" class="slider_align ui-slider ui-corner-all ui-slider-horizontal ui-widget ui-widget-content"></div>
						<input type="hidden" id="minprice" name="minprice" />
						<input type="hidden" id="maxprice" name="maxprice" />				
					</div>
					
					<div class="checkbox">
						<p><strong>성별</strong></p>
						<label class="col-xs-6">
							<input type="checkbox" name="gender" value="f" />여성전용
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="gender" value="m" />남성전용
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="gender" value="n" />남녀공용				
						</label>
					</div>
					
					<br />
					<br />
					
					<div class="checkbox">
						<p><strong>테마</strong></p>
						<label class="col-xs-6">
							<input type="checkbox" name="trip" value="1" />#관광
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="gourmet" value="1" />#맛집
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="shopping" value="1" />#쇼핑
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="businessTrip" value="1" />#출장				
						</label>
					</div>
					
					<br />
					<br />
					
					<div class="checkbox">
						<p><strong>편의시설</strong></p>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="1"/>세탁기
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="2"/>주차장
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="3"/>주방/식당
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="4"/>엘리베이터
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="5"/>취사가능
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="6"/>전자레인지
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="7"/>와이파이
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="8"/>에어컨
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="9"/>냉장고
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="10"/>욕조
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="11"/>드라이기
						</label>
						<label class="col-xs-6">
							<input type="checkbox" name="facilities" value="12"/>TV
						</label>
					</div>
					
					<button id="btn-search" type="submit" class="btn btn-default btn-block btn-danger" style="margin-top:180px;margin-bottom:30px;">검색</button>
				</form>
			</div>
			
			<div class="col-md-9 col-sm-8 maparea">
			
				<div id="map"></div>

				<hr />

				<div id="searchresult"> <!-- handlebars template target -->
					
				</div> <!-- searchresult end -->
				

			</div> <!-- end maparea -->
		</div> <!-- end row -->
	</div> <!-- end container -->
	
</div> <!-- end layout content -->

<div layout:fragment="script">
<!-- script start -->
	<!-- jquery/ui -->
	<script src="vendor/jquery/jquery.min.js"></script>
	<script src="vendor/jquery/jquery-ui.min.js"></script>
	
	<!-- handlebars -->
	<script src="js/handlebars4.js"></script>
	
	<!-- datepicker -->
	<script src="js/datepicker.js"></script>
	<script src="js/i18n/datepicker.en.js"></script>
	
	<!-- bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	
	<script>
	$(function(){
		/* 오늘날짜부터 선택가능 / input hidden으로 나누어서 저장 /세미콜론(;)넣지 않음 주의 */
	  	$(".datepicker-here").datepicker({
			language: 'en',
			minDate: new Date(),
			range: true,
			autoClose: true,
		    onSelect: function onSelect(fd, date){
		    	$("#startdate").val(fd.split(" ~ ")[0])
		    	$("#enddate").val(fd.split(" ~ ")[1])
		    }
		});
		
	  	/* slider-range */
	  	$("#slider-range").slider({
		      range: true,
		      min: 10000,
		      max: 300000,
		      step: 10000,
		      values: [ 10000, 300000 ],
		      slide: function( event, ui ) {
		        $("#amount").text( Math.floor(ui.values[0]/10000) + "만원 ~ " + Math.floor(ui.values[1]/10000) + "만원");
		        $("#minprice").val(ui.values[0]);
		        $("#maxprice").val(ui.values[1]);
		      }
		});
	  	
	   $("#amount").text( $( "#slider-range" ).slider( "values", 0 )/10000 + "만원" +
		      " ~ " + $( "#slider-range" ).slider( "values", 1 )/10000 + "만원" );
	   $("#minprice").val($( "#slider-range" ).slider( "values", 0 ));
	   $("#maxprice").val($( "#slider-range" ).slider( "values", 1 ));
	   
	   /* 인원수 버튼 구현 */
	   var personCnt = 1;
	   var spanPerson = $("span#person");
	   var inputPerson = $("input.person");
	   
	   $("button#up").click(function(){
		   plusCnt();
		   validCnt();
		   spanPerson.html(personCnt);
		   inputPerson.val(personCnt);
	   });
	   
	   $("button#down").click(function(){
		   minusCnt();
		   validCnt();
		   spanPerson.html(personCnt);
		   inputPerson.val(personCnt);
	   });
	   
	   function plusCnt(){
		   personCnt++;
	   }
	   function minusCnt(){
		   personCnt--;
	   }
	   function validCnt(){
		   if (personCnt >= 10){
			   personCnt = 10;
		   }
		   if (personCnt <= 1){
			   personCnt = 1;
		   }
	   }
	}); 
	</script>
	<script id="template" type="text/x-handlebars-template">
		{{#each .}}
			<div class="housewrapper col-lg-4 col-md-6 col-xs-12">
				<a href="{{guestHouseCode}}">
					<div class="houseborder">
						<div class="houseimage" style="background-image:url({{originalName}});">
						</div>
						<div class="contentwrapper">
							<div class="content gehaname">
								<h4><span class="gehaname">{{guestHouseName}}</span></h4>
							</div>
							<div class="content yellowline">
								<span class="rating">{{avgRating}}</span>
								<span class="ratingname">{{recommendRating}}</span>
								<span class="comments">({{reviewCnt}})</span>
							</div>
							<div class="content tag">
								{{#ifOne trip}}
									<span class="tag">#관광</span>
								{{/ifOne}}
								{{#ifOne gourmet}}
									<span class="tag">#맛집</span>
								{{/ifOne}}
								{{#ifOne shopping}}
									<span class="tag">#쇼핑</span>
								{{/ifOne}}
								{{#ifOne businesstrip}}
									<span class="tag">#출장</span>
								{{/ifOne}}
							</div>
							<div class="content price">
								<span class="price">{{minprice}}원</span>
							</div>
						</div>
					</div>
				</a>
			</div> <!-- housewrapper end -->
		{{/each}}
	</script>
	<script>
	$(function(){
		/* get Data from RestApi */
		$.getJSON("search/gehainfo", function(data){
			var source = $("#template").html();
			var template = Handlebars.compile(source);
			$("#searchresult").append(template(data));
		});
		
		/* handlebars ifOne helper for tags */
		Handlebars.registerHelper('ifOne', function(a, opts) {
		    if(a == 1) // Or === depending on your needs
		        return opts.fn(this);
		    else
		        return opts.inverse(this);
		});
		
	});
	</script>
	
<!-- script end -->
</div> <!-- end layout script -->

</body>
</html>